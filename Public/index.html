<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Prevent browser caching during development -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <title>Staff Schedule Templates</title>

    <!-- ğŸ’¡ UPDATE THIS NUMBER: Change ?v=1 to ?v=2, then ?v=3, etc. when you modify CSS -->
    <link rel="stylesheet" href="styles.css?v=1">
</head>
<body>
<!-- Authentication Check Script -->
<script>
    function checkAuthentication() {
        const isLoggedIn = localStorage.getItem('isAuthenticated');
        const rememberMe = localStorage.getItem('rememberMe');
        const loginTime = localStorage.getItem('loginTime');
        if (isLoggedIn !== 'true') {
            window.location.href = 'login.html';
            return;
        }
        if (rememberMe === 'true' && loginTime) {
            const thirtyDays = 30 * 24 * 60 * 60 * 1000;
            if ((Date.now() - parseInt(loginTime)) >= thirtyDays) {
                localStorage.removeItem('isAuthenticated');
                localStorage.removeItem('loginTime');
                localStorage.removeItem('rememberMe');
                window.location.href = 'login.html';
                return;
            }
        }
    }
    checkAuthentication();
</script>

<div class="container" id="scheduleContent">
    <div class="header">
        <h1><span class="calendar-icon" onclick="openScheduleManagerModal()">ğŸ“…</span> Weekly Staff Schedule</h1>
        <div class="header-actions">
            <div class="weekly-hours-display" onclick="openWeeklySummaryModal()">
                ğŸ“Š Hours: <span id="totalWeeklyHours">0</span>h
            </div>
            <div class="weekly-hours-display" onclick="openBudgetModal()" style="background: rgba(255, 255, 255, 0.15);">
                ğŸ’° Budget: <span id="budgetRemainingDisplay" style="font-weight: 700;">0</span>h
            </div>
            <button class="share-btn" onclick="openStaffListModal()">ğŸ‘¥ Staff</button>
            <button class="share-btn" onclick="logout()" style="background: #ff6b6b;">ğŸšª Logout</button>
        </div>
    </div>

    <div class="schedule-container">
        <div class="days-grid" id="daysGrid">
            <div class="week-date-display" id="weekDateDisplay"></div>
        </div>
    </div>
</div>

<!-- All your modals go here (keeping them to save space) -->
<div class="modal-overlay" id="staffModal"><div class="modal"><div class="modal-header"><div class="modal-title" id="modalStaffName"></div><button class="close-btn" onclick="closeModal()">&times;</button></div><div class="modal-content" id="modalContent"></div></div></div>
<div class="modal-overlay" id="addStaffModal"><div class="modal"><div class="modal-header"><div class="modal-title">â• Add Staff Member</div><button class="close-btn" onclick="closeAddStaffModal()">&times;</button></div><div class="modal-content"><form id="addStaffForm" onsubmit="addStaff(event)"><div class="form-group"><label>Day</label><input type="text" id="staffDay" readonly /></div><div class="form-group"><label>Shift</label><input type="text" id="staffShift" readonly /></div><div class="form-group"><label>Staff Member</label><select id="staffSelect" required onchange="populateStaffInfo()"><option value="">Select a staff member</option></select></div><div class="form-group"><label>Start Time</label><input type="time" id="staffStartTime" required /></div><div class="form-group"><label>End Time</label><input type="time" id="staffEndTime" required /></div><button type="submit" class="btn-primary">Add to Schedule</button></form></div></div></div>
<div class="modal-overlay" id="staffListModal"><div class="modal"><div class="modal-header"><div class="modal-title">ğŸ‘¥ Staff Directory</div><button class="close-btn" onclick="closeStaffListModal()">&times;</button></div><div class="modal-content"><button class="btn-primary" onclick="openCreateStaffModal()" style="margin-bottom: 20px;">â• Create New Staff Member</button><div id="staffListContent"></div></div></div></div>
<div class="modal-overlay" id="createStaffModal"><div class="modal"><div class="modal-header"><div class="modal-title">â• Create New Staff Member</div><button class="close-btn" onclick="closeCreateStaffModal()">&times;</button></div><div class="modal-content"><form id="createStaffForm" onsubmit="createStaff(event)"><div class="form-group"><label>Name</label><input type="text" id="newStaffName" required placeholder="Enter staff name" /></div><div class="form-group"><label>Role</label><input type="text" id="newStaffRole" required placeholder="e.g., Educator, Site Manager" /></div><button type="submit" class="btn-primary">Create Staff Member</button></form></div></div></div>
<div class="modal-overlay" id="quickAddModal"><div class="modal"><div class="modal-header"><div class="modal-title">â• Add to <span id="quickAddDay"></span></div><button class="close-btn" onclick="closeQuickAddModal()">&times;</button></div><div class="modal-content"><div class="action-type-selector"><button type="button" class="action-type-btn active" onclick="selectActionType('staff')">ğŸ‘¥ Add Staff</button><button type="button" class="action-type-btn" onclick="selectActionType('holiday')">ğŸ‰ Holiday/Event</button></div><form id="quickAddForm" onsubmit="quickAddStaff(event)" class="action-form active"><div class="form-group"><label>Shift</label><select id="quickShift" required><option value="">Select shift</option><option value="Morning">Morning</option><option value="Afternoon">Afternoon</option><option value="PM Meeting">PM Meeting</option></select></div><div class="form-group"><label>Staff Member</label><select id="quickStaffSelect" required><option value="">Select a staff member</option></select></div><div class="form-group"><label>Start Time</label><input type="time" id="quickStartTime" required /></div><div class="form-group"><label>End Time</label><input type="time" id="quickEndTime" required /></div><button type="submit" class="btn-primary">Add to Schedule</button></form><form id="holidayForm" onsubmit="addHoliday(event)" class="action-form"><div class="form-group"><label>Holiday/Event Name</label><input type="text" id="holidayName" placeholder="e.g., Christmas Day, Team Building" required /></div><div class="form-group"><label>Description (Optional)</label><textarea id="holidayDescription" rows="3" placeholder="Add any notes about this day off..."></textarea></div><div class="holiday-notice">â„¹ï¸ This will mark the entire day as off for all staff</div><button type="submit" class="btn-primary">Mark as Holiday/Event</button></form></div></div></div>
<div class="modal-overlay" id="weeklySummaryModal"><div class="modal"><div class="modal-header"><div class="modal-title">ğŸ“Š Weekly Summary</div><button class="close-btn" onclick="closeWeeklySummaryModal()">&times;</button></div><div class="modal-content"><div id="weeklySummaryContent"></div></div></div></div>
<div class="modal-overlay" id="scheduleManagerModal"><div class="modal modal-wide"><div class="modal-header"><div class="modal-title">ğŸ“… Schedule Templates</div><button class="close-btn" onclick="closeScheduleManagerModal()">&times;</button></div><div class="modal-content"><button class="btn-primary" onclick="openCreateScheduleModal()" style="margin-bottom: 20px;">â• Create New Template</button><div id="scheduleListContent"></div></div></div></div>
<div class="modal-overlay" id="createScheduleModal"><div class="modal"><div class="modal-header"><div class="modal-title">â• Create New Template</div><button class="close-btn" onclick="closeCreateScheduleModal()">&times;</button></div><div class="modal-content"><form id="createScheduleForm" onsubmit="createNewSchedule(event)"><div class="form-group"><label>Start Date</label><input type="date" id="newScheduleStartDate" required /></div><div class="form-group"><label>End Date</label><input type="date" id="newScheduleEndDate" required /></div><div class="form-group"><label style="display: flex; align-items: center; gap: 10px; cursor: pointer;"><input type="checkbox" id="isHolidayCheckbox" onchange="toggleHolidayInput()" style="width: 20px; height: 20px; cursor: pointer;" /><span>Mark as Holiday/Event Period</span></label></div><div class="form-group" id="holidayInputGroup" style="display: none;"><label>Holiday or Event Name</label><input type="text" id="newScheduleName" placeholder="e.g., Summer Break, Christmas Week" /><div style="font-size: 0.85em; color: #666; margin-top: 5px;">ğŸ“Œ This will mark all days in this period as off (no staff scheduled)</div></div><div class="form-group"><label>Budget Hours (Optional)</label><input type="number" id="newScheduleBudget" min="0" step="0.5" placeholder="e.g., 160" /><div style="font-size: 0.85em; color: #666; margin-top: 5px;">ğŸ’° Set the total hours budget for this week</div></div><button type="submit" class="btn-primary">Create Schedule</button></form></div></div></div>
<div class="modal-overlay" id="editBudgetModal"><div class="modal"><div class="modal-header"><div class="modal-title">ğŸ’° Set Budget Hours</div><button class="close-btn" onclick="closeBudgetModal()">&times;</button></div><div class="modal-content"><form id="editBudgetForm" onsubmit="saveBudget(event)"><div class="form-group"><label>Budget Hours for This Week</label><input type="number" id="editBudgetHours" min="0" step="0.5" placeholder="e.g., 160" required /><div style="font-size: 0.85em; color: #666; margin-top: 5px;">ğŸ’¡ The budget will decrease as you schedule staff</div></div><button type="submit" class="btn-primary">Adjust</button></form></div></div></div>

<!-- ğŸ’¡ UPDATE THIS NUMBER: Change ?v=1 to ?v=2, then ?v=3, etc. when you modify JS -->
<script src="app.js?v=1"></script>
</body>
</html>